<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Today I learnt : How to check if a url is on 2 way SSL or not ? | Codeklutz</title><meta name=keywords content="til,ssl,2wayssl,openssl,curl"><meta name=description content="Learning SSL itself is not a straight forward concept as it seems but even confirming if a particular url is on 2 way ssl requires some effort. I face some trouble with ssl in the past so just a blog post describing my pain.
1 way ssl Client -> Server When a client (browser) hits the url and it gives success for example Google.com.It is usually on 1 way ssl. In this case, only the client authenticates the server."><meta name=author content="Shweta Kadam"><link rel=canonical href=https://codeklutz.com/posts/today-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not/><meta name=google-site-verification content="G-3JJ1TEHZ1S"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://codeklutz.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://codeklutz.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://codeklutz.com/cat.gif><link rel=apple-touch-icon href=https://codeklutz.com/cat.gif><link rel=mask-icon href=https://codeklutz.com/cat.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-3JJ1TEHZ1S"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3JJ1TEHZ1S",{anonymize_ip:!1})}</script><meta property="og:title" content="Today I learnt : How to check if a url is on 2 way SSL or not ?"><meta property="og:description" content="Learning SSL itself is not a straight forward concept as it seems but even confirming if a particular url is on 2 way ssl requires some effort. I face some trouble with ssl in the past so just a blog post describing my pain.
1 way ssl Client -> Server When a client (browser) hits the url and it gives success for example Google.com.It is usually on 1 way ssl. In this case, only the client authenticates the server."><meta property="og:type" content="article"><meta property="og:url" content="https://codeklutz.com/posts/today-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not/"><meta property="og:image" content="https://codeklutz.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-18T00:00:00+00:00"><meta property="og:site_name" content="Codeklutz"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codeklutz.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Today I learnt : How to check if a url is on 2 way SSL or not ?"><meta name=twitter:description content="Learning SSL itself is not a straight forward concept as it seems but even confirming if a particular url is on 2 way ssl requires some effort. I face some trouble with ssl in the past so just a blog post describing my pain.
1 way ssl Client -> Server When a client (browser) hits the url and it gives success for example Google.com.It is usually on 1 way ssl. In this case, only the client authenticates the server."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://codeklutz.com/posts/"},{"@type":"ListItem","position":3,"name":"Today I learnt : How to check if a url is on 2 way SSL or not ?","item":"https://codeklutz.com/posts/today-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Today I learnt : How to check if a url is on 2 way SSL or not ?","name":"Today I learnt : How to check if a url is on 2 way SSL or not ?","description":"Learning SSL itself is not a straight forward concept as it seems but even confirming if a particular url is on 2 way ssl requires some effort. I face some trouble with ssl in the past so just a blog post describing my pain.\n1 way ssl Client -\u0026gt; Server When a client (browser) hits the url and it gives success for example Google.com.It is usually on 1 way ssl. In this case, only the client authenticates the server.","keywords":["til","ssl","2wayssl","openssl","curl"],"articleBody":"Learning SSL itself is not a straight forward concept as it seems but even confirming if a particular url is on 2 way ssl requires some effort. I face some trouble with ssl in the past so just a blog post describing my pain.\n1 way ssl Client -\u003e Server When a client (browser) hits the url and it gives success for example Google.com.It is usually on 1 way ssl. In this case, only the client authenticates the server.\nIf an API call(curl/postman) succeeds without passing any certificate, it’s on 1-way ssl.\nSo the situations might look like :\nIf one makes a curl call and it succeeds without passing any client cert with flags such as –key and –cert. then it is on 1-way SSL.\nIf the Postman API call succeeds without passing any client certificate in Postman (Preferences -\u003e Certificates tab -\u003e Client certificate tab) with Enable SSL certificate verification toggled on, it is on 1-way SSL.\nThe curl output of 1 way SSL looks like this.(Data has been changed and added fake data for DEMO Purposes):\n❯ curl -v https://exampleOf1wayySSL.com Trying 82.133.101.34... * TCP_NODELAY set * Connected to exampleOf1wayySSL.com (10.10.10.10.10) port 443 (#0) * ALPN, offering h2 * ALPN, offering http/1.1 * successfully set certificate verify locations: * CAfile: /etc/ssl/cert.pem CApath: none * TLSv1.2 (OUT), TLS handshake, Client hello (1): * TLSv1.2 (IN), TLS handshake, Server hello (2): * TLSv1.2 (IN), TLS handshake, Certificate (11): * TLSv1.2 (IN), TLS handshake, Server key exchange (12): * TLSv1.2 (IN), TLS handshake, Server finished (14): * TLSv1.2 (OUT), TLS handshake, Client key exchange (16): * TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): * TLSv1.2 (OUT), TLS handshake, Finished (20): * TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): * TLSv1.2 (IN), TLS handshake, Finished (20): * SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 * ALPN, server did not agree to a protocol * Server certificate: * subject: C=RANDOM; L=RANDOM; O=EXAMPLE. OHG; CN=*exampleof1wayssl * start date: Feb 11 00:00:00 2012 GMT * expire date: Mar 8 23:59:59 2024 GMT * subjectAltName: host \"exampleOf1wayssl.com\" matched cert's \"*.exampleof1wayssl\" * issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1 * SSL certificate verify ok. \u003e GET / HTTP/1.1 \u003e Host: exampleOf1wayySSL.com \u003e User-Agent: curl/7.64.1 \u003e Accept: / \u003e In this example as you can see only the client asked for the certificate with line TLSv1.2 (IN), TLS handshake, Certificate (11):\n2 way SSL (Client \u003c-\u003e Server) In 2 way ssl Both client and server ask for the certificate during SSL validation.So while validating the scenarios should look like this:\ncurl fails without passing any client cert. When one makes a CURL call to API/Endpoint (curl -v -k ) without passing flags such as --key and --cert, the curl call should fail with a handshake failure. From the response, make a note of the line with Request CERT (example below) So if a curl call succeeds without passing any flags, then it’s not on 2 way SSL.\nFor a 2-way SSL, the server would ask for a client certificate. (TLSv1.2 (IN), TLS handshake, Request CERT (13) in this case, example in code block below\nIn this example, we didn’t pass any certificate in curl with flags such as --key and --cert, and hence it resulted in handshake failure below * error:1401E410:SSL routines:CONNECT_CR_FINISHED:sslv3 alert handshake failure\ncurl -v -k https://2WaySSLExample.com * Trying 82.133.101.34.. * TCP_NODELAY set * Connected to 2WaySSLExample.com (82.133.101.34) port 443 (#0) * ALPN, offering h2 * ALPN, offering http/1.1 * successfully set certificate verify locations: * CAfile: /etc/ssl/cert.pem CApath: none * TLSv1.2 (OUT), TLS handshake, Client hello (1): * TLSv1.2 (IN), TLS handshake, Server hello (2): * TLSv1.2 (IN), TLS handshake, Certificate (11): * TLSv1.2 (IN), TLS handshake, Request CERT (13): * TLSv1.2 (IN), TLS handshake, Server finished (14): * TLSv1.2 (OUT), TLS handshake, Certificate (11): * TLSv1.2 (OUT), TLS handshake, Client key exchange (16): * TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): * TLSv1.2 (OUT), TLS handshake, Finished (20): * TLSv1.2 (IN), TLS alert, handshake failure (552): * error:1401E410:SSL routines:CONNECT_CR_FINISHED:sslv3 alert handshake failure * Closing connection 0 The server would ask for a client certificate in this case\nIn some unusual cases; it’s possible a server doesn’t directly ask for it but the client needs to send it or gets rejected. The standard is: the server asks for it.\ncurl fails without passing any client cert(NSS is used) Similar to /etc/ssl/cert.pem, NSS(Network Security Services) as a trusted CA certificate location. Another example of trusted CA cert location is jdk cacerts for java applications.\nAll three /etc/ssl/cert.pem, NSS, and JDK cacerts are used to store trusted root certificates but differ in their implementation and usage. So while using curl output of ssl handshake failure might look like this :\ncurl -v https://2WaySSLExampleUsingNSS.com * About to connect() to 2WaySSLExampleUsingNSS.com port 443 (#0) * Trying 82.133.101.34..... * Connected to 2WaySSLExampleUsingNSS.com (82.133.101.34) port 443 (#0) * Initializing NSS with certpath: sql:/etc/pki/nssdb * CAfile: /etc/pki/tls/certs/ca-bundle.crt CApath: none * NSS: client certificate not found (nickname not specified) * NSS error -12227 (SSL_ERROR_HANDSHAKE_FAILURE_ALERT) * SSL peer was unable to negotiate an acceptable set of security parameters. * Closing connection 0 curl: (35) NSS: client certificate not found (nickname not specified Make note of curl: (35) NSS: client certificate not found (nickname not specified) where we are not passing any client cert or key and get the expected error. curl -v –cacert ca.crt –key private.key –cert client.cer\nHappy curl case where we pass the client cert and key The happy case of a curl call where we pass client cert and key would look like this curl -v --cacert ca.crt --key private.key --cert client.cer\ncurl -v https://HappyCurlCase.com --key ./myKey.key --cert ./myCert-cert.crt * About to connect() toHappyCurlCase.com port 443 (#0) * Trying 82.133.101.34..... * Connected to HappyCurlCase.com ( 82.133.101.34) port 443 (#0) * Initializing NSS with certpath: sql:/etc/pki/nssdb * CAfile: /etc/pki/tls/certs/ca-bundle.crt CApath: none * NSS: client certificate from file * subject: E= ,CN=,OU=\u003e,O=_ * start date: Mar 24 13:31:56 2026 GMT * expire date: Mar 31 23:59:59 2029 GMT * common name: issuer:E= ,CN=,OU=\u003e,O=_ * SSL connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 * Server certificate: * subject: CN=,O= * start date: Mar 24 13:31:56 2026 GMT * expire date: Mar 31 23:59:59 2029 GMT * common name: * issuer: CN=DigiCert Global G1 TLS RSA SHA256 2020 CA1,O=DigiCert Inc,C=US \u003e GET / HTTP/1.1 \u003e User-Agent: curl/7.29.0 \u003e Host: HappyCurlCase.com \u003e Accept: / \u003e \u003c HTTP/1.1 404 Not Found \u003c Content-Type: application/json; charset=utf-8 \u003c Date: Tue, 28 Mar 2023 14:36:34 GMT \u003c Connection: keep-alive \u003c Keep-Alive: timeout=5 \u003c Content-Length: 41 \u003c Verifying if Client key is being used in authentication Many times I have faced a scenario where the other party claims that they configured 2 way ssl correctly but actually the key is never used in the ssl authentication process.So there are way to figure if its actually being used by looking for certain outputs.\nUsing openssl command. When trying to verify via openssl command, openssl s_client -servername someExampleDomain -connect someExampleDomain.com:443 ,for a happy case look for Acceptable client certificate CA names The client (browser or curl) must select the correct client certificate from its keystore location based on the rules below. If this doesn’t exist then it won’t use the client key. And this client key is stored any location your application or somewhere else.\nAcceptable client certificate CA names C = US, O = Example CA, CN = Example Root CA C = US, O = Example CA, CN = Example Intermediate CA openssl s_client -servername someExampleDomain -connect someExampleDomain.com:443 CONNECTED(00000003) depth=2 C = US, O = Example CA, CN = Example Root CA verify return:1 depth=1 C = US, O = Example CA, CN = Example Intermediate CA verify return:1 depth=0 C = US, ST = California, L = San Francisco, O = Example Inc., CN = someExampleDomain.com verify return:1 --- Certificate chain 0 s: C = US, ST = California, L = San Francisco, O = Example Inc., CN = someExampleDomain.com i: C = US, O = Example CA, CN = Example Intermediate CA 1 s: C = US, O = Example CA, CN = Example Intermediate CA i: C = US, O = Example CA, CN = Example Root CA --- Server certificate -----BEGIN CERTIFICATE----- MIIFzDCCBLSgAwIBAgIRAKBYEa+5G0pMFMWcTPWdDb8wDQYJKoZIhvcNAQELBQAw gYsxCzAJBgNVBAYTAlVTMRYwFAYDVQQIDA1DYWxpZm9ybmlhMRYwFAYDVQQHDA1T \u003c...Random Certificate content...\u003e fUeyIkVJ17E4wj1jv7dwD2NW9/Jg2U4vA5s2nRO2fX0CXU1IK1WueBq/AVhUo+3E cGxfJyzCvujpBT9tpH4twQ== -----END CERTIFICATE----- subject=C = US, ST = California, L = San Francisco, O = Example Inc., CN = someExampleDomain.com issuer=C = US, O = Example CA, CN = Example Intermediate CA --- Acceptable client certificate CA names C = US, O = Example CA, CN = Example Root CA C = US, O = Example CA, CN = Example Intermediate CA ---Server Temp Key: ECDH, P-256, 256 bits --- SSL handshake has read 2498 bytes and written 304 bytes Verification: OK --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 0 (ok) --- If you don’t see your CA(client’s CA) mentioned in the above Acceptable client certificate CA names section then that means the URL is not using the client key for authentication and there might have been misconfiguration. Another example of a client key not being used during SSL handshake is indicated by No client certificate CA names sent Example output :\n$ openssl s_client -servername someExampleDomain -connect someExampleDomain.com:443 CONNECTED(00000003) depth=2 C = US, O = Example CA, CN = Example Root CA verify return:1 depth=1 C = US, O = Example CA, CN = Example Intermediate CA verify return:1 depth=0 C = US, ST = California, L = San Francisco, O = Example Inc., CN = someExampleDomain.com verify return:1 --- Certificate chain 0 s: C = US, ST = California, L = San Francisco, O = Example Inc., CN = someExampleDomain.com i: C = US, O = Example CA, CN = Example Intermediate CA 1 s: C = US, O = Example CA, CN = Example Intermediate CA i: C = US, O = Example CA, CN = Example Root CA --- Server certificate -----BEGIN CERTIFICATE----- MIIFzDCCBLSgAwIBAgIRAKBYEa+5G0pMFMWcTPWdDb8wDQYJKoZIhvcNAQELBQAw gYsxCzAJBgNVBAYTAlVTMRYwFAYDVQQIDA1DYWxpZm9ybmlhMRYwFAYDVQQHDA1T YW4gRnJhbmNpc2NvMRMwEQYDVQQKDApFeGFtcGxlIENBMRIwEAYDVQQDDAlleGFt cGxlLmNvbTAeFw0yMTA5MTUwMzQzMjNaFw0yMTA5MTYwMzQzMjNaMEwxCzAJBgNV BAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRMwEQYDVQQHEwpTYW4gRnJhbmNp c2NvMRMwEQYDVQQKEwpFeGFtcGxlIEluYy4xEjAQBgNVBAMTCXNvbWVFeGFtcGxl LmNvbTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJDEi5WSU95UTq0A LanrVthBLYAmgU7X5D3HFF+T8Ghz9MbYa1Mw/eXxiC0vBo2eM1YyTS2JDLum56KU E3Moc5Vcm8yBtBgU2amKazSxS7VzQsEj5+lzp6f9yyzm32HeMeiTY4W31ehobLkj QYb6ChhQqWd0qXnoy9UoT2Cn1lRfIAYoJy1l2a/8Vt0Zk44MTKm4EGkmzRFm7JCu NyFNU5iR8p9yUmmupzDMDlum3VwsbtmYmLwib9EBK0rAF9DkR9QJcYeeV4bZiQv1 wjJthoPQ1sFIZsXdJCTUUK9l25H4xXHmWmpNfn9JlD5vGe \u003c...Certificate content...\u003e fUeyIkVJ17E4wj1jv7dwD2NW9/Jg2U4vA5s2nRO2fX0CXU1IK1WueBq/AVhUo+3E cGxfJyzCvujpBT9tpH4twQ== -----END CERTIFICATE----- subject=C = US, ST = California, L = San Francisco, O = Example Inc., CN = someExampleDomain.com issuer=C = US, O = Example CA, CN = Example Intermediate CA --- No client certificate CA names sent Server Temp Key: ECDH, P-256, 256 bits --- SSL handshake has read 2498 bytes and written 304 bytes Verification: OK --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 0 (ok) Using Java Flags in application logs One can also verify the same in Java by checking your application logs and enabling a flag -Djavax.net.debug=ssl or in some cases -Djavax.net.debug=all which gives more verbose logs. If the client key is not being during ssl handshake, the error log might look like this:\n*** ServerHelloDone [read] MD5 and SHA1 hashes: len = 4 0000: 0Z 00 00 00 .... Warning: no suitable certificate found - continuing without client authentication *** Certificate chain \u003cEmpty\u003e During a happy case you should see the chain below ServerHelloDone\n*** ServerHelloDone [read] MD5 and SHA1 hashes: len = 4 0000: 0Z 00 00 00 matching alias: \u003csome_random_alias\u003e *** Certificate chain chain [0] = [ [ These were some of the tricks I used to verify.In future blog posts, I will include how to test using Postman too. Happy Learning!\n","wordCount":"1929","inLanguage":"en","datePublished":"2023-06-18T00:00:00Z","dateModified":"2023-06-18T00:00:00Z","author":[{"@type":"Person","name":"Shweta Kadam"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://codeklutz.com/posts/today-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not/"},"publisher":{"@type":"Organization","name":"Codeklutz","logo":{"@type":"ImageObject","url":"https://codeklutz.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://codeklutz.com accesskey=h title="CodeKlutz (Alt + H)"><img src=https://codeklutz.com/cat.gif alt aria-label=logo height=40>CodeKlutz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://codeklutz.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://codeklutz.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://notes.codeklutz.com title="Notes Digital Hub"><span>Notes Digital Hub</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://codeklutz.com/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Today I learnt : How to check if a url is on 2 way SSL or not ?</h1><div class=post-meta><span title='2023-06-18 00:00:00 +0000 UTC'>June 18, 2023</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;1929 words&nbsp;·&nbsp;Shweta Kadam&nbsp;|&nbsp;<a href=https://github.com/myblog/content/posts/Today%20I%20learnt%20:%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-way-ssl-client-server>1 way ssl Client -> Server</a></li><li><a href=#2-way-ssl--client-server>2 way SSL (Client &lt;-> Server)</a><ul><li><a href=#curl-fails-without-passing-any-client-cert-dot>curl fails without passing any client cert.</a></li><li><a href=#curl-fails-without-passing-any-client-cert--nss-is-used>curl fails without passing any client cert(NSS is used)</a></li><li><a href=#happy-curl-case-where-we-pass-the-client-cert-and-key>Happy curl case where we pass the client cert and key</a></li><li><a href=#verifying-if-client-key-is-being-used-in-authentication>Verifying if Client key is being used in authentication</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>Learning SSL itself is not a straight forward concept as it seems but even confirming if a particular url is on 2 way ssl requires some effort. I face some trouble with ssl in the past so just a blog post describing my pain.</p><h2 id=1-way-ssl-client-server>1 way ssl Client -> Server<a hidden class=anchor aria-hidden=true href=#1-way-ssl-client-server>#</a></h2><p>When a client (browser) hits the url and it gives success for example Google.com.It is usually on 1 way ssl.
In this case, only the client authenticates the server.</p><blockquote><p>If an API call(curl/postman) succeeds without passing any certificate, it&rsquo;s on 1-way ssl.</p></blockquote><p>So the situations might look like :</p><ul><li><p>If one makes a curl call and it succeeds without passing any client cert with flags such as &ndash;key and &ndash;cert. then it is on 1-way SSL.</p><ul><li><p>If the Postman API call succeeds without passing any client certificate in Postman (Preferences -> Certificates tab -> Client certificate tab) with Enable SSL certificate verification toggled on, it is on 1-way SSL.</p><p>The curl output of 1 way SSL looks like this.(Data has been changed and added fake data for DEMO Purposes):</p><pre tabindex=0><code class=language-nil data-lang=nil>  ❯ curl -v https://exampleOf1wayySSL.com
  Trying 82.133.101.34...
   * TCP_NODELAY set
   * Connected to  exampleOf1wayySSL.com (10.10.10.10.10) port 443 (#0)
   * ALPN, offering h2
   * ALPN, offering http/1.1
   * successfully set certificate verify locations:
   *   CAfile: /etc/ssl/cert.pem
   CApath: none
   * TLSv1.2 (OUT), TLS handshake, Client hello (1):
   * TLSv1.2 (IN), TLS handshake, Server hello (2):
   * TLSv1.2 (IN), TLS handshake, Certificate (11):
   * TLSv1.2 (IN), TLS handshake, Server key exchange (12):
   * TLSv1.2 (IN), TLS handshake, Server finished (14):
   * TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
   * TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
   * TLSv1.2 (OUT), TLS handshake, Finished (20):
   * TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
   * TLSv1.2 (IN), TLS handshake, Finished (20):
   * SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256
   * ALPN, server did not agree to a protocol
   * Server certificate:
   *  subject: C=RANDOM; L=RANDOM; O=EXAMPLE. OHG; CN=*exampleof1wayssl
   *  start date: Feb 11 00:00:00 2012 GMT
   *  expire date: Mar  8 23:59:59 2024 GMT
   *  subjectAltName: host &#34;exampleOf1wayssl.com&#34; matched cert&#39;s &#34;*.exampleof1wayssl&#34;
   *  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
   *  SSL certificate verify ok.
  &gt; GET / HTTP/1.1
  &gt; Host:  exampleOf1wayySSL.com
  &gt; User-Agent: curl/7.64.1
  &gt; Accept: /
  &gt;
</code></pre><p>In this example as you can see only the client asked for the certificate with line <code>TLSv1.2 (IN), TLS handshake, Certificate (11):</code></p></li></ul></li></ul><h2 id=2-way-ssl--client-server>2 way SSL (Client &lt;-> Server)<a hidden class=anchor aria-hidden=true href=#2-way-ssl--client-server>#</a></h2><p>In 2 way ssl Both client and server ask for the certificate during SSL validation.So while validating the scenarios should look like this:</p><h3 id=curl-fails-without-passing-any-client-cert-dot>curl fails without passing any client cert.<a hidden class=anchor aria-hidden=true href=#curl-fails-without-passing-any-client-cert-dot>#</a></h3><p>When one makes a CURL call to API/Endpoint (curl -v -k &lt;baseURL/endpoint>) without passing flags such as <code>--key</code> and <code>--cert</code>, the curl call should fail with a handshake failure.
From the response, make a note of the line with <code>Request CERT</code> (example below)
So if a curl call succeeds without passing any flags, then it&rsquo;s not on 2 way SSL.</p><p>For a 2-way SSL, the server would ask for a client certificate. <code>(TLSv1.2 (IN), TLS handshake, Request CERT (13)</code> in this case, example in code block below</p><p>In this example, we didn&rsquo;t pass any certificate in curl with flags such as <code>--key</code> and <code>--cert</code>, and hence it resulted in handshake failure below <code>* error:1401E410:SSL routines:CONNECT_CR_FINISHED:sslv3 alert handshake failure</code></p><pre tabindex=0><code class=language-nil data-lang=nil>
  curl -v -k https://2WaySSLExample.com
   *   Trying 82.133.101.34..
   * TCP_NODELAY set
   * Connected to 2WaySSLExample.com (82.133.101.34) port 443 (#0)
   * ALPN, offering h2
   * ALPN, offering http/1.1
   * successfully set certificate verify locations:
   *   CAfile: /etc/ssl/cert.pem
   CApath: none
   * TLSv1.2 (OUT), TLS handshake, Client hello (1):
   * TLSv1.2 (IN), TLS handshake, Server hello (2):
   * TLSv1.2 (IN), TLS handshake, Certificate (11):
   * TLSv1.2 (IN), TLS handshake, Request CERT (13):
   * TLSv1.2 (IN), TLS handshake, Server finished (14):
   * TLSv1.2 (OUT), TLS handshake, Certificate (11):
   * TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
   * TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
   * TLSv1.2 (OUT), TLS handshake, Finished (20):
   * TLSv1.2 (IN), TLS alert, handshake failure (552):
   * error:1401E410:SSL routines:CONNECT_CR_FINISHED:sslv3 alert handshake failure
   * Closing connection 0
</code></pre><p><strong>The server would ask for a client certificate in this case</strong></p><p>In some unusual cases; it&rsquo;s possible a server doesn&rsquo;t directly ask for it but the client needs to send it or gets rejected. The standard is: the server asks for it.</p><h3 id=curl-fails-without-passing-any-client-cert--nss-is-used>curl fails without passing any client cert(NSS is used)<a hidden class=anchor aria-hidden=true href=#curl-fails-without-passing-any-client-cert--nss-is-used>#</a></h3><p>Similar to <code>/etc/ssl/cert.pem</code>, NSS(Network Security Services) as a trusted CA certificate location. Another example of trusted CA cert location is jdk cacerts for java applications.</p><p>All three <code>/etc/ssl/cert.pem</code>, <code>NSS</code>, and <code>JDK cacerts</code> are used to store trusted root certificates but differ in their implementation and usage.
So while using curl output of ssl handshake failure might look like this :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -v https://2WaySSLExampleUsingNSS.com
</span></span><span class=line><span class=cl> * About to connect<span class=o>()</span> to 2WaySSLExampleUsingNSS.com port <span class=m>443</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl> * Trying 82.133.101.34.....
</span></span><span class=line><span class=cl> * Connected to 2WaySSLExampleUsingNSS.com <span class=o>(</span>82.133.101.34<span class=o>)</span> port <span class=m>443</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl> * Initializing NSS with certpath: sql:/etc/pki/nssdb
</span></span><span class=line><span class=cl> * CAfile: /etc/pki/tls/certs/ca-bundle.crt
</span></span><span class=line><span class=cl> CApath: none
</span></span><span class=line><span class=cl> * NSS: client certificate not found <span class=o>(</span>nickname not specified<span class=o>)</span>
</span></span><span class=line><span class=cl> * NSS error -12227 <span class=o>(</span>SSL_ERROR_HANDSHAKE_FAILURE_ALERT<span class=o>)</span>
</span></span><span class=line><span class=cl> * SSL peer was unable to negotiate an acceptable <span class=nb>set</span> of security parameters.
</span></span><span class=line><span class=cl> * Closing connection <span class=m>0</span>
</span></span><span class=line><span class=cl>curl: <span class=o>(</span>35<span class=o>)</span> NSS: client certificate not found <span class=o>(</span>nickname not specified
</span></span></code></pre></div><p>Make note of <code>curl: (35) NSS: client certificate not found (nickname not specified)</code> where we are not passing any client cert or key and get the expected error.
curl -v &lt;url> &ndash;cacert ca.crt &ndash;key private.key  &ndash;cert client.cer</p><h3 id=happy-curl-case-where-we-pass-the-client-cert-and-key>Happy curl case where we pass the client cert and key<a hidden class=anchor aria-hidden=true href=#happy-curl-case-where-we-pass-the-client-cert-and-key>#</a></h3><p>The happy case of a curl call where we pass client cert and key would look like this <code>curl -v &lt;url> --cacert ca.crt --key private.key  --cert client.cer</code></p><pre tabindex=0><code class=language-nil data-lang=nil>curl -v https://HappyCurlCase.com --key ./myKey.key --cert ./myCert-cert.crt
 * About to connect() toHappyCurlCase.com  port 443 (#0)
 *   Trying 82.133.101.34.....
 * Connected to HappyCurlCase.com ( 82.133.101.34) port 443 (#0)
 * Initializing NSS with certpath: sql:/etc/pki/nssdb
 *   CAfile: /etc/pki/tls/certs/ca-bundle.crt
   CApath: none
 * NSS: client certificate from file
 *   subject: E=&lt;SOME_ISSUER&gt; ,CN=&lt;SOME_CN&gt;,OU=&lt;SOME_OU&gt;&gt;,O=&lt;SOME_RANDOM_VALUE&gt;_
 *   start date: Mar 24 13:31:56 2026 GMT
 *   expire date: Mar 31 23:59:59 2029 GMT
 *   common name: &lt;some_common_name&gt;
 issuer:E=&lt;SOME_ISSUER&gt; ,CN=&lt;SOME_CN&gt;,OU=&lt;SOME_OU&gt;&gt;,O=&lt;SOME_RANDOM_VALUE&gt;_
 * SSL connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
 * Server certificate:
 *   subject: CN=&lt;some_common_name&gt;,O=&lt;some_organization&gt;
 *   start date: Mar 24 13:31:56 2026 GMT
 * expire date: Mar 31 23:59:59 2029 GMT
 *    common name: &lt;some_common_name&gt;
 *   issuer: CN=DigiCert Global G1 TLS RSA SHA256 2020 CA1,O=DigiCert Inc,C=US
&gt; GET / HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: HappyCurlCase.com
&gt; Accept: /
&gt;
&lt; HTTP/1.1 404 Not Found
&lt; Content-Type: application/json; charset=utf-8
&lt; Date: Tue, 28 Mar 2023 14:36:34 GMT
&lt; Connection: keep-alive
&lt; Keep-Alive: timeout=5
&lt; Content-Length: 41
&lt;
</code></pre><h3 id=verifying-if-client-key-is-being-used-in-authentication>Verifying if Client key is being used in authentication<a hidden class=anchor aria-hidden=true href=#verifying-if-client-key-is-being-used-in-authentication>#</a></h3><p>Many times I have faced a scenario where the other party claims that they configured 2 way ssl correctly but actually the key is never used in the ssl authentication process.So there are way to figure if its actually being used by looking for certain outputs.</p><h4 id=using-openssl-command-dot>Using openssl command.<a hidden class=anchor aria-hidden=true href=#using-openssl-command-dot>#</a></h4><p>When trying to verify via openssl command, <code>openssl s_client -servername someExampleDomain -connect someExampleDomain.com:443</code> ,for a happy case look for <code>Acceptable client certificate CA names</code>
The client (browser or curl) must select the correct client certificate from its keystore location based on the rules below. If this doesn&rsquo;t exist then it won&rsquo;t use the client key.
And this client key is stored any location your application or somewhere else.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Acceptable client certificate CA names
</span></span><span class=line><span class=cl><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Root CA
</span></span><span class=line><span class=cl><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>openssl s_client -servername someExampleDomain -connect someExampleDomain.com:443
</span></span><span class=line><span class=cl>CONNECTED<span class=o>(</span>00000003<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>2</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Root CA
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>1</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>0</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> California, <span class=nv>L</span> <span class=o>=</span> San Francisco, <span class=nv>O</span> <span class=o>=</span> Example Inc., <span class=nv>CN</span> <span class=o>=</span> someExampleDomain.com
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Certificate chain
</span></span><span class=line><span class=cl> <span class=m>0</span> s: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> California, <span class=nv>L</span> <span class=o>=</span> San Francisco, <span class=nv>O</span> <span class=o>=</span> Example Inc., <span class=nv>CN</span> <span class=o>=</span> someExampleDomain.com
</span></span><span class=line><span class=cl>   i: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl> <span class=m>1</span> s: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>   i: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Root CA
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Server certificate
</span></span><span class=line><span class=cl>-----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>MIIFzDCCBLSgAwIBAgIRAKBYEa+5G0pMFMWcTPWdDb8wDQYJKoZIhvcNAQELBQAw
</span></span><span class=line><span class=cl>gYsxCzAJBgNVBAYTAlVTMRYwFAYDVQQIDA1DYWxpZm9ybmlhMRYwFAYDVQQHDA1T
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;...Random Certificate content...&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>fUeyIkVJ17E4wj1jv7dwD2NW9/Jg2U4vA5s2nRO2fX0CXU1IK1WueBq/AVhUo+3E
</span></span><span class=line><span class=cl><span class=nv>cGxfJyzCvujpBT9tpH4twQ</span><span class=o>==</span>
</span></span><span class=line><span class=cl>-----END CERTIFICATE-----
</span></span><span class=line><span class=cl><span class=nv>subject</span><span class=o>=</span><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> California, <span class=nv>L</span> <span class=o>=</span> San Francisco, <span class=nv>O</span> <span class=o>=</span> Example Inc., <span class=nv>CN</span> <span class=o>=</span> someExampleDomain.com
</span></span><span class=line><span class=cl><span class=nv>issuer</span><span class=o>=</span><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Acceptable client certificate CA names
</span></span><span class=line><span class=cl><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Root CA
</span></span><span class=line><span class=cl><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---Server Temp Key: ECDH, P-256, <span class=m>256</span> bits
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>SSL handshake has <span class=nb>read</span> <span class=m>2498</span> bytes and written <span class=m>304</span> bytes
</span></span><span class=line><span class=cl>Verification: OK
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
</span></span><span class=line><span class=cl>Server public key is <span class=m>2048</span> bit
</span></span><span class=line><span class=cl>Secure Renegotiation IS supported
</span></span><span class=line><span class=cl>Compression: NONE
</span></span><span class=line><span class=cl>Expansion: NONE
</span></span><span class=line><span class=cl>No ALPN negotiated
</span></span><span class=line><span class=cl>Early data was not sent
</span></span><span class=line><span class=cl>Verify <span class=k>return</span> code: <span class=m>0</span> <span class=o>(</span>ok<span class=o>)</span>
</span></span><span class=line><span class=cl>---
</span></span></code></pre></div><p>If you don&rsquo;t see your CA(client&rsquo;s CA) mentioned in the above <code>Acceptable client certificate CA names</code> section then that means the URL is not using the client key for authentication and there might have been misconfiguration.
Another example of a client key not being used during SSL handshake is indicated by <code>No client certificate CA names sent</code>
Example output :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ openssl s_client -servername someExampleDomain -connect someExampleDomain.com:443
</span></span><span class=line><span class=cl>CONNECTED<span class=o>(</span>00000003<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>2</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Root CA
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>1</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>0</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> California, <span class=nv>L</span> <span class=o>=</span> San Francisco, <span class=nv>O</span> <span class=o>=</span> Example Inc., <span class=nv>CN</span> <span class=o>=</span> someExampleDomain.com
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Certificate chain
</span></span><span class=line><span class=cl> <span class=m>0</span> s: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> California, <span class=nv>L</span> <span class=o>=</span> San Francisco, <span class=nv>O</span> <span class=o>=</span> Example Inc., <span class=nv>CN</span> <span class=o>=</span> someExampleDomain.com
</span></span><span class=line><span class=cl>   i: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl> <span class=m>1</span> s: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>   i: <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Root CA
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Server certificate
</span></span><span class=line><span class=cl>-----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>MIIFzDCCBLSgAwIBAgIRAKBYEa+5G0pMFMWcTPWdDb8wDQYJKoZIhvcNAQELBQAw
</span></span><span class=line><span class=cl>gYsxCzAJBgNVBAYTAlVTMRYwFAYDVQQIDA1DYWxpZm9ybmlhMRYwFAYDVQQHDA1T
</span></span><span class=line><span class=cl>YW4gRnJhbmNpc2NvMRMwEQYDVQQKDApFeGFtcGxlIENBMRIwEAYDVQQDDAlleGFt
</span></span><span class=line><span class=cl>cGxlLmNvbTAeFw0yMTA5MTUwMzQzMjNaFw0yMTA5MTYwMzQzMjNaMEwxCzAJBgNV
</span></span><span class=line><span class=cl>BAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRMwEQYDVQQHEwpTYW4gRnJhbmNp
</span></span><span class=line><span class=cl>c2NvMRMwEQYDVQQKEwpFeGFtcGxlIEluYy4xEjAQBgNVBAMTCXNvbWVFeGFtcGxl
</span></span><span class=line><span class=cl>LmNvbTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJDEi5WSU95UTq0A
</span></span><span class=line><span class=cl>LanrVthBLYAmgU7X5D3HFF+T8Ghz9MbYa1Mw/eXxiC0vBo2eM1YyTS2JDLum56KU
</span></span><span class=line><span class=cl>E3Moc5Vcm8yBtBgU2amKazSxS7VzQsEj5+lzp6f9yyzm32HeMeiTY4W31ehobLkj
</span></span><span class=line><span class=cl>QYb6ChhQqWd0qXnoy9UoT2Cn1lRfIAYoJy1l2a/8Vt0Zk44MTKm4EGkmzRFm7JCu
</span></span><span class=line><span class=cl>NyFNU5iR8p9yUmmupzDMDlum3VwsbtmYmLwib9EBK0rAF9DkR9QJcYeeV4bZiQv1
</span></span><span class=line><span class=cl>wjJthoPQ1sFIZsXdJCTUUK9l25H4xXHmWmpNfn9JlD5vGe
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;...Certificate content...&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>fUeyIkVJ17E4wj1jv7dwD2NW9/Jg2U4vA5s2nRO2fX0CXU1IK1WueBq/AVhUo+3E
</span></span><span class=line><span class=cl><span class=nv>cGxfJyzCvujpBT9tpH4twQ</span><span class=o>==</span>
</span></span><span class=line><span class=cl>-----END CERTIFICATE-----
</span></span><span class=line><span class=cl><span class=nv>subject</span><span class=o>=</span><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> California, <span class=nv>L</span> <span class=o>=</span> San Francisco, <span class=nv>O</span> <span class=o>=</span> Example Inc., <span class=nv>CN</span> <span class=o>=</span> someExampleDomain.com
</span></span><span class=line><span class=cl><span class=nv>issuer</span><span class=o>=</span><span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> Example CA, <span class=nv>CN</span> <span class=o>=</span> Example Intermediate CA
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>No client certificate CA names sent
</span></span><span class=line><span class=cl>Server Temp Key: ECDH, P-256, <span class=m>256</span> bits
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>SSL handshake has <span class=nb>read</span> <span class=m>2498</span> bytes and written <span class=m>304</span> bytes
</span></span><span class=line><span class=cl>Verification: OK
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
</span></span><span class=line><span class=cl>Server public key is <span class=m>2048</span> bit
</span></span><span class=line><span class=cl>Secure Renegotiation IS supported
</span></span><span class=line><span class=cl>Compression: NONE
</span></span><span class=line><span class=cl>Expansion: NONE
</span></span><span class=line><span class=cl>No ALPN negotiated
</span></span><span class=line><span class=cl>Early data was not sent
</span></span><span class=line><span class=cl>Verify <span class=k>return</span> code: <span class=m>0</span> <span class=o>(</span>ok<span class=o>)</span>
</span></span></code></pre></div><h4 id=using-java-flags-in-application-logs>Using Java Flags in application logs<a hidden class=anchor aria-hidden=true href=#using-java-flags-in-application-logs>#</a></h4><p>One can also verify the same in Java by checking your application logs and enabling a flag <code>-Djavax.net.debug=ssl</code> or in some cases <code>-Djavax.net.debug=all</code> which gives more verbose logs.
If the client key is not being during ssl handshake, the error log might look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>***</span> <span class=n>ServerHelloDone</span>
</span></span><span class=line><span class=cl> <span class=o>[</span><span class=n>read</span><span class=o>]</span> <span class=n>MD5</span> <span class=n>and</span> <span class=n>SHA1</span> <span class=n>hashes</span><span class=o>:</span>  <span class=n>len</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl> <span class=mo>0000</span><span class=o>:</span> <span class=mi>0</span><span class=n>Z</span> <span class=mo>00</span> <span class=mo>00</span> <span class=mo>00</span>                                        <span class=o>....</span>
</span></span><span class=line><span class=cl> <span class=n>Warning</span><span class=o>:</span> <span class=n>no</span> <span class=n>suitable</span> <span class=n>certificate</span> <span class=n>found</span> <span class=o>-</span> <span class=n>continuing</span> <span class=n>without</span> <span class=n>client</span> <span class=n>authentication</span>
</span></span><span class=line><span class=cl> <span class=o>***</span> <span class=n>Certificate</span> <span class=n>chain</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>Empty</span><span class=o>&gt;</span>
</span></span></code></pre></div><p>During a happy case you should see the chain below ServerHelloDone</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>***</span> <span class=n>ServerHelloDone</span>
</span></span><span class=line><span class=cl> <span class=o>[</span><span class=n>read</span><span class=o>]</span> <span class=n>MD5</span> <span class=n>and</span> <span class=n>SHA1</span> <span class=n>hashes</span><span class=o>:</span>  <span class=n>len</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl> <span class=mo>0000</span><span class=o>:</span> <span class=mi>0</span><span class=n>Z</span> <span class=mo>00</span> <span class=mo>00</span> <span class=mo>00</span>
</span></span><span class=line><span class=cl> <span class=n>matching</span> <span class=n>alias</span><span class=o>:</span> <span class=o>&lt;</span><span class=n>some_random_alias</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl> <span class=o>***</span> <span class=n>Certificate</span> <span class=n>chain</span>
</span></span><span class=line><span class=cl><span class=n>chain</span> <span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=o>=</span> <span class=o>[</span>
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span></code></pre></div><p>These were some of the tricks I used to verify.In future blog posts, I will include how to test using Postman too.
Happy Learning!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://codeklutz.com/tags/til/>til</a></li><li><a href=https://codeklutz.com/tags/ssl/>ssl</a></li><li><a href=https://codeklutz.com/tags/2wayssl/>2wayssl</a></li><li><a href=https://codeklutz.com/tags/openssl/>openssl</a></li><li><a href=https://codeklutz.com/tags/curl/>curl</a></li></ul><nav class=paginav><a class=next href=https://codeklutz.com/posts/beware-of-the-side-bug/><span class=title>Next »</span><br><span>Beware of the side bug</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Today I learnt : How to check if a url is on 2 way SSL or not ? on twitter" href="https://twitter.com/intent/tweet/?text=Today%20I%20learnt%20%3a%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not%20%3f&amp;url=https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f&amp;hashtags=til%2cssl%2c2wayssl%2copenssl%2ccurl"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Today I learnt : How to check if a url is on 2 way SSL or not ? on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f&amp;title=Today%20I%20learnt%20%3a%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not%20%3f&amp;summary=Today%20I%20learnt%20%3a%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not%20%3f&amp;source=https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Today I learnt : How to check if a url is on 2 way SSL or not ? on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f&title=Today%20I%20learnt%20%3a%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not%20%3f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Today I learnt : How to check if a url is on 2 way SSL or not ? on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Today I learnt : How to check if a url is on 2 way SSL or not ? on whatsapp" href="https://api.whatsapp.com/send?text=Today%20I%20learnt%20%3a%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not%20%3f%20-%20https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Today I learnt : How to check if a url is on 2 way SSL or not ? on telegram" href="https://telegram.me/share/url?text=Today%20I%20learnt%20%3a%20How%20to%20check%20if%20a%20url%20is%20on%202%20way%20SSL%20or%20not%20%3f&amp;url=https%3a%2f%2fcodeklutz.com%2fposts%2ftoday-i-learnt-how-to-check-if-a-url-is-on-2-way-ssl-or-not%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><script src=https://utteranc.es/client.js repo=shwetarkadam/myblog issue-term=url label=codeklutz theme=github-dark crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://codeklutz.com>Codeklutz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>